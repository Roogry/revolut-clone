<header
  class="fixed top-0 left-0 w-full z-50 border-b border-[#ebebf0] transition-all duration-300"
  [class.bg-white]="showMegaMenu() || isMobileMenuOpen()"
  [class.bg-white/80]="isScrolled() && !showMegaMenu() && !isMobileMenuOpen()"
  [class.backdrop-blur-lg]="isScrolled() && !showMegaMenu() && !isMobileMenuOpen()"
  [class.bg-transparent]="!isScrolled() && !showMegaMenu() && !isMobileMenuOpen()"
  [class.-translate-y-full]="isHidden() && !isMobileMenuOpen()"
>
  <!-- Top Navigation Bar -->
  <div class="max-w-[1000px] mx-auto px-5 py-3 lg:px-6 lg:py-4 flex items-center justify-between">
    <!-- Left Side: Logo & Nav Pills -->
    <div class="flex-1 h-full flex items-center gap-8">
      <!-- Logo -->
      <a
        href="#"
        class="text-2xl font-bold tracking-tight z-50 relative"
        [class.text-gray-900]="isScrolled() || showMegaMenu() || isMobileMenuOpen()"
        [class.text-white]="!isScrolled() && !showMegaMenu() && !isMobileMenuOpen()"
        >Moneytor</a
      >

      <!-- Nav Pills (Desktop) -->
      <div
        (mouseenter)="setIsNavHovered(true)"
        (mouseleave)="setIsNavHovered(false)"
        class="hidden lg:flex flex-1 h-full items-center"
      >
        <nav class="flex p-1">
          @for (item of navItems; track item.id) {
            <button
              (mouseenter)="setActiveTab(item.id)"
              class="px-4 py-1.5 rounded-full text-sm font-medium cursor-pointer transition-all duration-200"
              [class.bg-gray-200]="showMegaMenu() && activeTab() === item.id"
              [class.text-gray-900]="showMegaMenu() && activeTab() === item.id"
              [class.text-gray-600]="
                (isScrolled() && !showMegaMenu()) || (activeTab() !== item.id && showMegaMenu())
              "
              [class.text-white]="!isScrolled() && !showMegaMenu() && activeTab() !== item.id"
              [class.hover:text-gray-900]="showMegaMenu() || isScrolled()"
              [class.hover:text-white]="!showMegaMenu() && !isScrolled()"
            >
              {{ item.label }}
            </button>
          }
        </nav>
      </div>
    </div>

    <!-- Right Side: Actions (Desktop) -->
    <div class="hidden lg:flex items-center gap-4 text-base leading-[1.375rem] font-medium">
      <button
        class="px-6 py-[10px] rounded-full cursor-pointer hover:bg-black hover:text-white transition-colors"
        [class.text-black]="showMegaMenu() || isScrolled()"
        [class.text-white]="!showMegaMenu() && !isScrolled()"
      >
        Log in
      </button>
      <button
        class="px-6 py-[10px] rounded-full cursor-pointer hover:bg-gray-300 transition-colors"
        [class.bg-black]="showMegaMenu() || isScrolled()"
        [class.text-white]="showMegaMenu() || isScrolled()"
        [class.bg-white]="!showMegaMenu() && !isScrolled()"
        [class.text-black]="!showMegaMenu() && !isScrolled()"
      >
        Sign up
      </button>
    </div>

    <!-- Hamburger Button (Mobile/Tablet) -->
    <button
      class="lg:hidden z-50 p-[0.125rem]"
      (click)="toggleMobileMenu()"
      [class.text-gray-900]="isScrolled() || showMegaMenu() || isMobileMenuOpen()"
      [class.text-white]="!isScrolled() && !showMegaMenu() && !isMobileMenuOpen()"
    >
      @if (isMobileMenuOpen()) {
        <svg
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          stroke-width="2"
          stroke="currentColor"
          class="size-[1.325rem]"
        >
          <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12" />
        </svg>
      } @else {
        <svg
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          stroke-width="2"
          stroke="currentColor"
          class="size-[1.325rem]"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"
          />
        </svg>
      }
    </button>
  </div>

  <!-- Mobile Menu Overlay -->
  @if (isMobileMenuOpen()) {
    <div
      class="fixed inset-0 bg-white z-40 mt-[56px] flex flex-col lg:hidden animate-in fade-in slide-in-from-top-4 duration-300"
    >
      <div class="p-6 overflow-y-auto">
        <!-- Nav Pills Strip -->
        <div class="mb-4 overflow-x-auto">
          <div class="flex gap-2">
            @for (item of navItems; track item.id) {
              <button
                class="px-2.5 py-[8px] rounded-full text-base leading-[1.375rem] font-medium whitespace-nowrap transition-colors hover:bg-[#e2e2e7] hover:opacity-100"
                [class.bg-[#e2e2e7]/70]="mobileActiveTab() === item.id"
                (click)="setMobileActiveTab(item.id)"
              >
                {{ item.label }}
              </button>
            }
          </div>
        </div>

        <!-- Mega Menu Content -->
        <div class="flex-1">
          <app-mega-menu [data]="mobileMenuData()"></app-mega-menu>
        </div>
      </div>

      <!-- Sticky Bottom Actions -->
      <div class="mt-auto p-3 border-t border-gray-100 bg-[#f7f7f7] shrink-0 sticky-bottom-action">
        <div class="flex items-center justify-center gap-4">
          <button
            class="py-[10px] px-6 rounded-full text-[#191c1f] bg-white cursor-pointer transition-colors hover:bg-gray-200 hover:opacity-[.85]"
            (click)="toggleMobileMenu()"
          >
            Log in
          </button>
          <button
            class="py-[10px] px-6 rounded-full text-white bg-[#191c1f] cursor-pointer transition-colors hover:opacity-[.85]"
            (click)="toggleMobileMenu()"
          >
            Sign up
          </button>
        </div>
      </div>
    </div>
  }

  <!-- Mega Menu -->
  @if (showMegaMenu()) {
    <div
      class="border-t border-gray-100 bg-white animate-in fade-in slide-in-from-top-2 duration-200"
      (mouseenter)="setMegaMenuHovered(true)"
      (mouseleave)="setMegaMenuHovered(false)"
    >
      <app-mega-menu [data]="activeMenuData()"></app-mega-menu>
    </div>
  }
</header>
